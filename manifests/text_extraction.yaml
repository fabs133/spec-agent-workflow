name: text_extraction
description: "Load text files -> Extract structured items via LLM -> Write output"
version: "1.0"

defaults:
  model: gpt-4o
  temperature: 0.3

steps:
  intake:
    agent: intake_agent
    specs:
      pre: [intake_pre]
      post: [intake_post]
      invariant: [global_invariant]
    retry:
      max_attempts: 2
      delay_seconds: 1.0

  extract:
    agent: extract_agent
    specs:
      pre: [extract_pre]
      post: [extract_post]
      invariant: [global_invariant]
    retry:
      max_attempts: 3
      delay_seconds: 2.0

  write:
    agent: write_agent
    specs:
      pre: [write_pre]
      post: [write_post]
      invariant: [global_invariant]
    retry:
      max_attempts: 2
      delay_seconds: 1.0

edges:
  - from: intake
    to: extract
    condition: on_pass
  - from: extract
    to: write
    condition: on_pass

entry_step: intake

budgets:
  max_retries_per_step: 3
  max_total_steps: 20
